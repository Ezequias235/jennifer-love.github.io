<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Para ti, Jennifer❤️</title>
  <link rel="icon" type="image/png" href="Jennifer.png">
  <style>
    :root { --bg:#fff6fb; --accent:#ff66aa; --text:#4b2a2a; }
    * { box-sizing:border-box; margin:0; padding:0; }

    body {
      min-height:100vh;
      font-family:'Poppins',sans-serif;
      color:var(--text);
      background:radial-gradient(circle at top,#fff0f8,#ffd6e8,#ffe6f6);
      overflow-y:auto;
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
      align-items:center;
      position:relative;
      animation:fadeInBody 2s ease forwards;
      scroll-behavior:smooth;
      padding-top:20px;
    }

    @keyframes fadeInBody { from{opacity:0;} to{opacity:1;} }
    @keyframes fadeUp { from{opacity:0;transform:translateY(30px);} to{opacity:1;transform:translateY(0);} }
    @keyframes float { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-8px);} }
    @keyframes heartbeat { 0%,100%{transform:scale(1);} 50%{transform:scale(1.08);} }

    .card-start {
      width:90%;
      max-width:300px;
      background:rgba(255,255,255,0.9);
      border-radius:20px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
      box-shadow:0 8px 25px rgba(255,102,170,0.4);
      cursor:pointer;
      padding:20px;
      transition:opacity 0.6s ease, transform 0.6s ease;
      animation:fadeUp 1s ease forwards;
      margin:20px 0;
    }

    .card-start h2 {
      color:var(--accent);
      font-size:22px;
      margin-bottom:10px;
      animation:fadeUp 1s ease;
    }

    .card-start p { font-size:16px;color:#5a3a3a;margin-bottom:10px; }

    .btn, .btn-regresar, .confirm-btn, .cancel-btn, .story-btn {
      display:block;
      width:160px;
      padding:8px 0;
      margin:5px auto;
      background:var(--accent);
      color:white;
      border:none;
      border-radius:12px;
      cursor:pointer;
      font-weight:bold;
      transition:0.3s;
      text-decoration:none;
      text-align:center;
      animation:fadeUp 1.2s ease;
    }

    .btn:hover, .btn-regresar:hover, .confirm-btn:hover, .cancel-btn:hover, .story-btn:hover { 
      background:#ff3388; 
      transform:scale(1.05); 
    }

    .cancel-btn { 
      background:#a35a6a; 
    }

    .cancel-btn:hover { 
      background:#8a4a5a; 
    }

    .container, .momentos, .musica, .enamore, .galeria {
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      padding:30px 10px;
      max-width:500px;
      width:100%;
      display:none;
      opacity:0;
      transition:opacity 0.6s ease,transform 0.6s ease;
    }

    .show { display:flex; opacity:1; animation:fadeUp 1s ease forwards; }

    h1.main-title {
      font-size:50px;
      text-align:center;
      text-shadow:0 0 10px rgba(255,0,120,0.4);
      margin-bottom:30px;
      color:var(--accent);
      animation:heartbeat 3s infinite ease-in-out;
    }

    .portrait {
      width:180px;
      height:180px;
      border-radius:50%;
      background:url('Jennifer.png') center/cover no-repeat;
      box-shadow:0 10px 40px rgba(255,0,150,0.4);
      border:5px solid white;
      margin-bottom:30px;
      animation:float 4s ease-in-out infinite;
    }

    .textblock {
      background:rgba(255,255,255,0.75);
      padding:25px;
      border-radius:25px;
      width:100%;
      text-align:center;
      backdrop-filter:blur(10px);
      box-shadow:0 8px 25px rgba(0,0,0,0.15);
      margin-bottom:20px;
      animation:fadeUp 1s ease forwards;
    }

    .textblock h2 { color:var(--accent); font-size:24px; margin-bottom:15px; }
    .textblock p { font-size:16px; line-height:1.6; color:#5a3a3a; }

    .moment-card {
      background:rgba(255,255,255,0.8);
      border-radius:20px;
      box-shadow:0 5px 20px rgba(255,102,170,0.3);
      padding:20px;
      text-align:center;
      margin-bottom:20px;
      width:100%;
      animation:fadeUp 1s ease;
    }

    .moment-card img { width:100%; border-radius:15px; margin-bottom:10px; }
    .moment-card h3 { color:var(--accent); font-size:20px; margin-bottom:5px; }
    .moment-card .fecha { font-size:14px; color:#a35a6a; margin-bottom:10px; }
    .moment-card p { font-size:15px; color:#5a3a3a; }

    .song-card {
      background:rgba(255,255,255,0.8);
      border-radius:20px;
      box-shadow:0 5px 20px rgba(255,102,170,0.3);
      padding:18px;
      text-align:center;
      margin-bottom:16px;
      width:100%;
      animation:fadeUp 1s ease;
    }
    .song-card h3 { color:var(--accent); margin-bottom:8px; font-size:18px; }
    .song-card p { font-size:14px; color:#5a3a3a; line-height:1.5; }

    iframe {
      width:100%;
      height:200px;
      border:none;
      border-radius:12px;
      margin-top:10px;
      box-shadow:0 4px 12px rgba(0,0,0,0.12);
    }

    footer {
      margin-top:10px;
      color:#a35a6a;
      font-size:14px;
      text-align:center;
      margin-bottom:30px;
      animation:fadeUp 2s ease;
    }

    .heart-bg { position:fixed; inset:0; overflow:hidden; z-index:-1; }
    .floating-heart {
      position:absolute;
      opacity:0.9;
      animation:floatHeart linear forwards;
      transform:translate(-50%,-50%);
    }

    @keyframes floatHeart {
      0% {opacity:0;transform:translate(0,0) rotate(0deg);}
      10%{opacity:1;}
      90%{opacity:1;}
      100% {opacity:0;transform:translate(var(--moveX),var(--moveY)) rotate(360deg);}
    }

    /* Estilos para Cómo me enamoré - Juego Interactivo */
    .story-game {
      background: rgba(255,255,255,0.8);
      border-radius:20px;
      box-shadow:0 5px 20px rgba(255,102,170,0.3);
      padding:20px;
      width:100%;
      text-align:center;
      margin-bottom:20px;
    }

    .story-step {
      display: none;
      animation: fadeUp 1s ease;
    }

    .story-step.active {
      display: block;
    }

    .story-step h3 { color:var(--accent); font-size:20px; margin-bottom:10px; }
    .story-step p { font-size:15px; color:#5a3a3a; margin-bottom:15px; line-height:1.6; }

    .story-btn {
      display: inline-block;
      margin: 5px;
    }

    /* Estilos para el textarea en Tu promesa */
    .promise-textarea {
      width: 100%;
      min-height: 100px;
      padding: 10px;
      border: 2px solid var(--accent);
      border-radius: 10px;
      font-family: 'Poppins', sans-serif;
      font-size: 15px;
      color: var(--text);
      background: rgba(255, 255, 255, 0.9);
      resize: vertical;
      margin-bottom: 15px;
      transition: border-color 0.3s ease;
    }

    .promise-textarea:focus {
      outline: none;
      border-color: #ff3388;
      box-shadow: 0 0 8px rgba(255, 102, 170, 0.4);
    }

    .promise-saved {
      font-size: 15px;
      color: #5a3a3a;
      margin-bottom: 15px;
      line-height: 1.6;
      background: rgba(255, 255, 255, 0.95);
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    /* Estilos para Galería de Fotos */
    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 10px;
      width: 100%;
      margin-bottom: 20px;
    }

    .gallery-item {
      cursor: pointer;
      position: relative;
      animation: float 4s ease-in-out infinite;
      animation-delay: calc(var(--index) * 0.2s);
    }

    .gallery-item img {
      width: 100%;
      height: auto;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }

    .gallery-item:hover img {
      transform: scale(1.05);
    }

    .upload-container {
      margin-top: 20px;
      text-align: center;
    }

    /* Modal para galería con carousel */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background-color: rgba(0,0,0,0.9);
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      position: relative;
      width: 90%;
      max-width: 800px;
      max-height: 80vh;
      margin: auto;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }

    .slideshow-container {
      width: 100%;
      max-height: 80vh;
      position: relative;
      display: flex;
      overflow: hidden;
      touch-action: pan-y pinch-zoom;
    }

    .mySlides {
      display: none;
      width: 100%;
      flex-shrink: 0;
      text-align: center;
      transition: transform 0.3s ease;
      position: relative;
      height: 100%;
    }

    .mySlides img {
      width: 100%;
      max-height: 70vh;
      object-fit: contain;
      border-radius: 10px;
      position: relative;
      z-index: 1;
    }

    .delete-x {
      position: absolute;
      top: 10px;
      right: 10px;
      color: #ff0000; /* Changed to red */
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
      border: 2px solid #ff0000; /* Red border */
      border-radius: 50%;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: 0.3s;
      z-index: 3;
      background-color: rgba(255,255,255,0.8); /* White background for contrast */
    }

    .delete-x:hover {
      background-color: rgba(255,0,0,0.2); /* Light red background on hover */
      border-color: #cc0000; /* Darker red border on hover */
      color: #cc0000; /* Darker red color on hover */
    }

    .prev, .next {
      cursor: pointer;
      position: fixed;
      top: 50%;
      width: auto;
      padding: 16px;
      margin-top: -50px;
      color: white;
      font-weight: bold;
      font-size: 24px;
      transition: 0.3s ease;
      border-radius: 0 5px 5px 0;
      user-select: none;
      background-color: rgba(0,0,0,0.5);
      z-index: 2;
    }

    .prev { left: 10px; }
    .next { right: 10px; border-radius: 5px 0 0 5px; }

    .prev:hover, .next:hover {
      background-color: rgba(0,0,0,0.8);
    }

    .close {
      position: fixed;
      top: 20px;
      right: 35px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      transition: 0.3s;
      z-index: 3;
    }

    .close:hover,
    .close:focus {
      color: #bbb;
      text-decoration: none;
      cursor: pointer;
    }

    /* Estilos para el diálogo de confirmación */
    .confirm-dialog {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255,255,255,0.95);
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 8px 25px rgba(255,102,170,0.4);
      text-align: center;
      max-width: 80%;
      width: 300px;
      z-index: 10; /* Increased z-index to ensure it’s on top */
      animation: fadeUp 0.3s ease forwards;
    }

    .confirm-dialog.show {
      display: block;
    }

    .confirm-dialog p {
      font-size: 16px;
      color: var(--text);
      margin-bottom: 20px;
    }

    .confirm-dialog .confirm-btn, .confirm-dialog .cancel-btn {
      display: inline-block;
      width: 120px;
      margin: 0 10px;
    }

    @media(max-width:480px){
      h1.main-title{font-size:36px;}
      .portrait{width:140px;height:140px;}
      .textblock h2{font-size:20px;}
      .textblock p{font-size:14px;}
      .card-start{width:90%;padding:15px;}
      .btn,.btn-regresar,.confirm-btn,.cancel-btn,.story-btn{width:120px;}
      .modal-content { max-width: 95%; max-height: 90vh; }
      .mySlides img { max-height: 60vh; }
      .prev, .next { font-size: 18px; padding: 12px; }
      .delete-x { font-size: 20px; width: 25px; height: 25px; }
      .confirm-dialog { max-width: 90%; width: 250px; }
      .confirm-dialog .confirm-btn, .confirm-dialog .cancel-btn { width: 100px; }
      .promise-textarea { font-size: 14px; min-height: 80px; }
      .promise-saved { font-size: 14px; }
    }
  </style>
</head>
<body>
  <div class="heart-bg" id="heartBg"></div>

  <div class="card-start" id="cardStart">
    <h2>📜 Carta para ti 📜</h2>
    <button id="btnCarta" class="btn">Leer Carta</button>
    <h2>🎶 Te la dedico 🎶</h2>
    <button id="btnMusica" class="btn">Escuchar Música</button>
    <h2>Momentos Vividos</h2>
    <button id="btnMomentosInicio" class="btn">Ver Momentos</button>
    <h2>¿Cómo me enamoré?</h2>
    <button id="btnEnamore" class="btn">Ver Historia</button>
    <h2>📸 Galería de Fotos 📸</h2>
    <button id="btnGaleria" class="btn">Ver Galería</button>
  </div>

  <div class="musica" id="musica">
    <h1 class="main-title">Música dedicada</h1>
    <div class="song-card">
      <h3>🎧 Canción: Ivan Cornejo - Está Dañada</h3>
      <p>Elegí esta canción para ti porque sé que has pasado por momentos difíciles, pero también sé lo especial que eres. Quiero que recuerdes tu sonrisa, tu alegría, esas cosas que te hacen única. Que sepas que mereces ser feliz, que mereces volver a confiar y disfrutar de la vida… y yo quiero estar ahí para que esos momentos sean aún mejores contigo.</p>
      <iframe src="https://www.youtube.com/embed/rBLLbgD0FsM" allowfullscreen></iframe>
    </div>
    <div class="song-card">
      <h3>🎧 Canción: Kevin Kaarl - no me culpes por sentir</h3>
      <p>He elegido esta canción porque refleja lo que siento en estos momentos: la confusión en mis pensamientos, preguntándome si realmente quieres a alguien como yo o si solo soy yo quien lo siente. También siento que quizás te estoy presionando, aunque tal vez no lo veas así, o tal vez yo no sea lo que buscas.</p>
      <iframe src="https://www.youtube.com/embed/R0pwwqnGE9A" allowfullscreen></iframe>
    </div>
    <button id="btnVolverMusica" class="btn-regresar">Regresar</button>
  </div>

  <div class="container" id="container">
    <h1 class="main-title">Para ti, Jennifer.</h1>
    <div class="portrait"></div>
    <div class="textblock">
      <h2>🌷 Carta para ti, Jennifer 🌷</h2>
      <p>Desde la primera vez que te vi, sentí algo diferente.</p>
      <p>Mi corazón empezó a latir más rápido y, sin saber por qué, mi mente creó un mundo nuevo contigo dentro.</p>
      <p>Desde entonces, no dejo de pensarte; me imagino cómo sería algo entre nosotros, algo real, algo distinto.</p>
      <p>A veces me cuesta explicar lo que siento, me pongo nervioso a tu lado, pero sé que es algo grande. Todo lo que hago por ti lo hago con cariño, porque de verdad te valoro y siento que te mereces mucho más de lo que imaginas.</p>
      <p>No sé si algún día encuentre la forma de encajar en tu corazón, pero tú, sin darte cuenta, ya encontraste tu lugar en el mío.</p>
      <p>Aun cuando no estás cerca, mi corazón te siente… hoy, mañana y siempre. ❤️</p>
      <p>No sé cómo demostrarte que de verdad le importas mucho a mi corazón…</p>
      <p style="margin-top:20px;font-weight:bold;">Att: Ezequías Martínez</p>
      <div style="margin-top:15px;width:120px;height:120px;border-radius:50%;background:url('Ezequias.png') center/cover no-repeat;margin-left:auto;margin-right:auto;box-shadow:0 5px 15px rgba(0,0,0,0.2);animation:float 5s ease-in-out infinite;"></div>
      <button id="btnRegresar" class="btn-regresar">Regresar</button>
    </div>
    <footer>— Ezequias 💖 —</footer>
  </div>

  <div class="momentos" id="momentos">
    <h1 class="main-title">Momentos Vividos</h1>
    <div class="moment-card">
      <img src="PrimerMensaje.png" alt="Momento en el que te conocí">
      <h3>Momento en el que te conocí</h3>
      <div class="fecha">📅 17 de septiembre de 2025</div>
      <p>Ese día sentí como si mi corazón hubiese estado mucho tiempo cubierto de polvo; mis pensamientos sobre el amor revivieron, y aunque duramos un mes sin hablarnos en persona, sentí una conexión en cada mensaje, en cada mirada y en cada sonrisa. Recuerdo que el primer viernes de empresa vi el mar y el cielo tan azules, que sentí como si mis días comenzaran a iluminarse y a llenarse de color.</p>
    </div>
    <div class="moment-card">
      <img src="flores.png" alt="Primer día que hablamos de verdad">
      <h3>El día en que te di flores amarillas</h3>
      <div class="fecha">📅 21 de septiembre de 2025</div>
      <p>Realmente tenía un poco de nervios ese día; fue la primera vez que mi corazón sintió algo tan especial. Automáticamente, mi corazón se abrió hacia ti. Cuando me diste ese abrazo, para mí fueron como veinte segundos en los que mis problemas se apagaron, las voces interiores se silenciaron. Aunque hayan sido gestos simples, los hice con el corazón. Siento que esas flores se ven muy bonitas, igual que tú.</p>
    </div>
    <div class="moment-card">
      <img src="ojos.png" alt="Día de la confianza">
      <h3>Primer día que sentí confianza hacia ti</h3>
      <div class="fecha">📅 3 de octubre de 2025</div>
      <p>Aunque el momento fue chistoso, fue un día en el que me hiciste sentir confiado al enviarme ese chinchón que te diste en la frente. Aún lo recuerdo, y tus ojos siguen siendo hermosos.</p>
    </div>
    <button id="btnVolverInicio" class="btn-regresar">Regresar</button>
  </div>

  <!-- Apartado Cómo me enamoré - Juego Interactivo -->
  <div class="enamore" id="enamore">
    <h1 class="main-title">Juego: Cómo me enamoré</h1>
    <div class="story-game">
      <div class="story-step active" id="step1">
        <h3>Razones</h3>
        <p>Siento que tienes un corazón muy lindo por tu forma de ser y por cómo te demuestras conmigo, aunque a veces seas un poco dura al expresarte. Me encanta tu mirada, tus ojitos cuando me miras, y tu sonrisa al hablarme o contarme cualquier cosa. Tu timidez te hace aún más especial, y cada vez que estás cerca me haces sentir en paz; al abrazarte o simplemente al saber que estás ahí, mis problemas parecen desvanecerse y me siento tranquilo. Hay algo en ti que me atrae sin saber exactamente qué es, sin razón aparente; cada vez que te veo me siento diferente, y aunque no sé qué es exactamente, todo lo que siento por ti es real.</p>
        <button class="story-btn" onclick="nextStep(2)">Continuar ❤️</button>
      </div>
      <div class="story-step" id="step2">
        <h3>Por qué</h3>
        <p>Mis sentimientos crecieron porque me mostraste interés; no sé exactamente qué decirte, como cuando te expresaste nerviosa o tímida. Te he abierto mi corazón; puedes tomarlo, y si no te corresponde, simplemente has que corresponda 😁👍. Y aunque me contaste que te entregaste completamente a otra persona emocionalmente, siento que mereces ser amada, cuidada y respetada. Quiero ser esa persona que poco a poco te ame, que te quiera cada día a su lado y que te demuestre un interés real.</p>
        <button class="story-btn" onclick="prevStep(1)">Anterior</button>
        <button class="story-btn" onclick="nextStep(3)">Siguiente ✨</button>
      </div>
      <div class="story-step" id="step3">
        <h3>Tu Ojitos y Sonrisa</h3>
        <p>Tus ojitos y tu sonrisa… me enamoré completamente de ellos. Me encanta cómo me miras y sonríes al mismo tiempo. También admiro mucho cuando sonríes y me hablas; tus pupilas siguen vivas, y quiero ayudarte a mantenerlas siempre así, llenas de vida y alegría. Quiero descubrir ese paraíso que hay en tu corazón, arreglar los momentos mal vividos dentro de ti y estudiarte, conocer cada parte de ti poco a poco para entenderte y cuidarte como te mereces.</p>
        <button class="story-btn" onclick="prevStep(2)">Anterior</button>
        <button class="story-btn" onclick="nextStep(4)">Siguiente 🌟</button>
      </div>
      <div class="story-step" id="step4">
        <h3>Mi promesa</h3>
        <p>No todos los días son buenos, ni todos los días son de color azul, pero prometo que si alguna vez llega a pasar algo, siempre estaré ahí para ti en lo que sea posible. Siempre te llevo presente en mis pensamientos, así que eso no hace falta prometerlo; siempre será así. Prometo que todo lo que vivamos será bonito, que no habrá desinterés ni desconfianza, porque realmente te quiero muchísimo.</p>
        <button class="story-btn" onclick="prevStep(3)">Anterior</button>
        <button class="story-btn" onclick="nextStep(5)">Siguiente 💖</button>
      </div>
      <div class="story-step" id="step5">
        <h3>Tu promesa</h3>
        <p>Escribe aquí tu promesa para mí, Jennifer. 💖</p>
        <textarea class="promise-textarea" id="promiseInput" placeholder="Escribe tu promesa..."></textarea>
        <button class="story-btn" id="savePromiseBtn">Guardar Promesa</button>
        <div class="promise-saved" id="savedPromise" style="display: none;"></div>
        <button class="story-btn" onclick="prevStep(4)">Anterior</button>
        <button class="story-btn btn-regresar" onclick="returnToMain()">Regresar</button>
      </div>
    </div>
    <button id="btnVolverEnamore" class="btn-regresar">Regresar</button>
  </div>

  <!-- Apartado Galería de Fotos -->
  <div class="galeria" id="galeria">
    <h1 class="main-title">Galería de Fotos</h1>
    <div class="gallery-grid" id="galleryGrid">
      <div class="gallery-item" data-index="0" onclick="openModal(0)" style="--index:0">
        <img src="PrimerMensaje.png" alt="Primer Mensaje">
      </div>
      <div class="gallery-item" data-index="1" onclick="openModal(1)" style="--index:1">
        <img src="flores.png" alt="Flores Amarillas">
      </div>
      <div class="gallery-item" data-index="2" onclick="openModal(2)" style="--index:2">
        <img src="ojos.png" alt="Ojos Hermosos">
      </div>
      <div class="gallery-item" data-index="3" onclick="openModal(3)" style="--index:3">
        <img src="Jennifer.png" alt="Jennifer">
      </div>
      <div class="gallery-item" data-index="4" onclick="openModal(4)" style="--index:4">
        <img src="Ezequias.png" alt="Ezequias">
      </div>
      <div class="gallery-item" data-index="5" onclick="openModal(5)" style="--index:5">
        <img src="PrimerMensaje.png" alt="Otro Momento">
      </div>
    </div>
    <div class="upload-container">
      <label for="photoUpload" class="btn" style="cursor: pointer;">Subir Fotos desde Teléfono/Galería</label>
      <input type="file" id="photoUpload" accept="image/*" multiple style="display: none;">
    </div>
    <button id="btnVolverGaleria" class="btn-regresar">Regresar</button>
  </div>

  <!-- Modal con Carousel -->
  <div id="photoModal" class="modal">
    <span class="close" onclick="closeModal()">&times;</span>
    <div class="modal-content">
      <div class="slideshow-container" id="slideshowContainer">
        <div class="mySlides" data-index="0">
          <img src="PrimerMensaje.png" alt="Primer Mensaje">
          <span class="delete-x" onclick="showConfirmDialog(0, event)">&times;</span>
          <div class="confirm-dialog" data-index="0">
            <p>¿Estás seguro de que quieres eliminar esta foto?</p>
            <button class="confirm-btn" onclick="confirmDelete(0)">Confirmar</button>
            <button class="cancel-btn" onclick="cancelDelete()">Cancelar</button>
          </div>
        </div>
        <div class="mySlides" data-index="1">
          <img src="flores.png" alt="Flores Amarillas">
          <span class="delete-x" onclick="showConfirmDialog(1, event)">&times;</span>
          <div class="confirm-dialog" data-index="1">
            <p>¿Estás seguro de que quieres eliminar esta foto?</p>
            <button class="confirm-btn" onclick="confirmDelete(1)">Confirmar</button>
            <button class="cancel-btn" onclick="cancelDelete()">Cancelar</button>
          </div>
        </div>
        <div class="mySlides" data-index="2">
          <img src="ojos.png" alt="Ojos Hermosos">
          <span class="delete-x" onclick="showConfirmDialog(2, event)">&times;</span>
          <div class="confirm-dialog" data-index="2">
            <p>¿Estás seguro de que quieres eliminar esta foto?</p>
            <button class="confirm-btn" onclick="confirmDelete(2)">Confirmar</button>
            <button class="cancel-btn" onclick="cancelDelete()">Cancelar</button>
          </div>
        </div>
        <div class="mySlides" data-index="3">
          <img src="Jennifer.png" alt="Jennifer">
          <span class="delete-x" onclick="showConfirmDialog(3, event)">&times;</span>
          <div class="confirm-dialog" data-index="3">
            <p>¿Estás seguro de que quieres eliminar esta foto?</p>
            <button class="confirm-btn" onclick="confirmDelete(3)">Confirmar</button>
            <button class="cancel-btn" onclick="cancelDelete()">Cancelar</button>
          </div>
        </div>
        <div class="mySlides" data-index="4">
          <img src="Ezequias.png" alt="Ezequias">
          <span class="delete-x" onclick="showConfirmDialog(4, event)">&times;</span>
          <div class="confirm-dialog" data-index="4">
            <p>¿Estás seguro de que quieres eliminar esta foto?</p>
            <button class="confirm-btn" onclick="confirmDelete(4)">Confirmar</button>
            <button class="cancel-btn" onclick="cancelDelete()">Cancelar</button>
          </div>
        </div>
        <div class="mySlides" data-index="5">
          <img src="PrimerMensaje.png" alt="Otro Momento">
          <span class="delete-x" onclick="showConfirmDialog(5, event)">&times;</span>
          <div class="confirm-dialog" data-index="5">
            <p>¿Estás seguro de que quieres eliminar esta foto?</p>
            <button class="confirm-btn" onclick="confirmDelete(5)">Confirmar</button>
            <button class="cancel-btn" onclick="cancelDelete()">Cancelar</button>
          </div>
        </div>
      </div>
      <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
      <a class="next" onclick="plusSlides(1)">&#10095;</a>
    </div>
  </div>

  <audio id="clickSound" src="click.mp3" preload="auto"></audio>

  <script>
    const cardStart = document.getElementById('cardStart');
    const container = document.getElementById('container');
    const momentos = document.getElementById('momentos');
    const musica = document.getElementById('musica');
    const enamore = document.getElementById('enamore');
    const galeria = document.getElementById('galeria');
    const heartBg = document.getElementById('heartBg');
    const clickSound = document.getElementById('clickSound');

    const btnCarta = document.getElementById('btnCarta');
    const btnMusica = document.getElementById('btnMusica');
    const btnRegresar = document.getElementById('btnRegresar');
    const btnMomentosInicio = document.getElementById('btnMomentosInicio');
    const btnVolverInicio = document.getElementById('btnVolverInicio');
    const btnVolverMusica = document.getElementById('btnVolverMusica');
    const btnEnamore = document.getElementById('btnEnamore');
    const btnVolverEnamore = document.getElementById('btnVolverEnamore');
    const btnGaleria = document.getElementById('btnGaleria');
    const btnVolverGaleria = document.getElementById('btnVolverGaleria');

    const playClick = () => { clickSound.currentTime = 0; clickSound.play(); };

    [btnCarta, btnMusica, btnRegresar, btnMomentosInicio, btnVolverInicio, btnVolverMusica, btnEnamore, btnVolverEnamore, btnGaleria, btnVolverGaleria].forEach(b => {
      if (b) b.addEventListener('click', playClick);
    });

    btnCarta.addEventListener('click', () => {
      cardStart.style.opacity = 0;
      cardStart.style.transform = "scale(0.95)";
      setTimeout(() => { cardStart.style.display = 'none'; container.classList.add('show'); }, 500);
    });

    btnRegresar.addEventListener('click', () => {
      container.classList.remove('show');
      setTimeout(() => { cardStart.style.display = 'flex'; cardStart.style.opacity = 1; cardStart.style.transform = "scale(1)"; }, 500);
    });

    btnMomentosInicio.addEventListener('click', () => {
      cardStart.style.opacity = 0;
      cardStart.style.transform = "scale(0.95)";
      setTimeout(() => { cardStart.style.display = 'none'; momentos.classList.add('show'); }, 500);
    });

    btnVolverInicio.addEventListener('click', () => {
      momentos.classList.remove('show');
      setTimeout(() => { cardStart.style.display = 'flex'; cardStart.style.opacity = 1; cardStart.style.transform = "scale(1)"; }, 500);
    });

    btnMusica.addEventListener('click', () => {
      cardStart.style.opacity = 0;
      cardStart.style.transform = "scale(0.95)";
      setTimeout(() => { cardStart.style.display = 'none'; musica.classList.add('show'); }, 500);
    });

    btnVolverMusica.addEventListener('click', () => {
      musica.classList.remove('show');
      setTimeout(() => { cardStart.style.display = 'flex'; cardStart.style.opacity = 1; cardStart.style.transform = "scale(1)"; }, 500);
    });

    btnEnamore.addEventListener('click', () => {
      cardStart.style.opacity = 0;
      cardStart.style.transform = "scale(0.95)";
      setTimeout(() => { 
        cardStart.style.display = 'none'; 
        enamore.classList.add('show'); 
        resetStory();
        loadPromise();
      }, 500);
    });

    btnVolverEnamore.addEventListener('click', () => {
      enamore.classList.remove('show');
      setTimeout(() => { cardStart.style.display = 'flex'; cardStart.style.opacity = 1; cardStart.style.transform = "scale(1)"; }, 500);
    });

    btnGaleria.addEventListener('click', () => {
      cardStart.style.opacity = 0;
      cardStart.style.transform = "scale(0.95)";
      setTimeout(() => { 
        cardStart.style.display = 'none'; 
        galeria.classList.add('show'); 
        loadGalleryImages(); // Load persisted images
      }, 500);
    });

    btnVolverGaleria.addEventListener('click', () => {
      galeria.classList.remove('show');
      setTimeout(() => { cardStart.style.display = 'flex'; cardStart.style.opacity = 1; cardStart.style.transform = "scale(1)"; }, 500);
    });

    // Corazones flotando
    function createHeart() {
      const heart = document.createElement('div');
      heart.classList.add('floating-heart');
      heart.innerText = ['💖', '💘', '💞', '❤️'][Math.floor(Math.random() * 4)];
      const startX = Math.random() > 0.5 ? '-10vw' : '110vw';
      const endX = startX === '-10vw' ? '110vw' : '-10vw';
      const startY = Math.random() * 100 + 'vh';
      const endY = Math.random() * 100 + 'vh';
      heart.style.left = startX;
      heart.style.top = startY;
      heart.style.setProperty('--moveX', `calc(${endX} - ${startX})`);
      heart.style.setProperty('--moveY', `calc(${endY} - ${startY})`);
      heart.style.fontSize = 15 + Math.random() * 25 + 'px';
      heart.style.animationDuration = 6 + Math.random() * 6 + 's';
      heartBg.appendChild(heart);
      setTimeout(() => heart.remove(), 12000);
    }
    setInterval(createHeart, 700);

    // Modal y Carousel para galería
    let slideIndex = 1;
    let galleryImages = [
      { src: 'PrimerMensaje.png', alt: 'Primer Mensaje', isLocal: true },
      { src: 'flores.png', alt: 'Flores Amarillas', isLocal: true },
      { src: 'ojos.png', alt: 'Ojos Hermosos', isLocal: true },
      { src: 'Jennifer.png', alt: 'Jennifer', isLocal: true },
      { src: 'Ezequias.png', alt: 'Ezequias', isLocal: true },
      { src: 'PrimerMensaje.png', alt: 'Otro Momento', isLocal: true }
    ];

    // Load persisted images from localStorage
    function loadGalleryImages() {
      const savedImages = localStorage.getItem('galleryImages');
      if (savedImages) {
        const parsedImages = JSON.parse(savedImages);
        galleryImages = [...galleryImages.filter(img => img.isLocal), ...parsedImages.filter(img => !img.isLocal)];
      }
      rebuildGallery();
    }

    function saveGalleryImages() {
      const imagesToSave = galleryImages.filter(img => !img.isLocal);
      localStorage.setItem('galleryImages', JSON.stringify(imagesToSave));
    }

    function openModal(n) {
      const modal = document.getElementById('photoModal');
      modal.style.display = 'flex';
      showSlides(slideIndex = n + 1);
      setupSwipe();
    }

    function closeModal() {
      const modal = document.getElementById('photoModal');
      document.querySelectorAll('.confirm-dialog').forEach(dialog => dialog.classList.remove('show'));
      modal.style.display = 'none';
    }

    function plusSlides(n) {
      document.querySelectorAll('.confirm-dialog').forEach(dialog => dialog.classList.remove('show'));
      showSlides(slideIndex += n);
      playClick();
    }

    function showSlides(n) {
      let slides = document.getElementsByClassName("mySlides");
      if (n > slides.length) { slideIndex = 1 }
      if (n < 1) { slideIndex = slides.length }
      for (let i = 0; i < slides.length; i++) {
        slides[i].style.display = "none";
        slides[i].style.transform = "translateX(0)";
      }
      slides[slideIndex - 1].style.display = "block";
    }

    // Swipe Functionality
    let touchStartX = 0;
    let touchEndX = 0;
    let isDragging = false;

    function setupSwipe() {
      const slideshowContainer = document.getElementById('slideshowContainer');
      slideshowContainer.addEventListener('touchstart', (e) => {
        touchStartX = e.changedTouches[0].screenX;
        isDragging = true;
      });

      slideshowContainer.addEventListener('touchmove', (e) => {
        if (isDragging) {
          touchEndX = e.changedTouches[0].screenX;
          const diffX = touchStartX - touchEndX;
          const slide = document.getElementsByClassName("mySlides")[slideIndex - 1];
          slide.style.transform = `translateX(${-diffX}px)`;
        }
      });

      slideshowContainer.addEventListener('touchend', (e) => {
        if (isDragging) {
          touchEndX = e.changedTouches[0].screenX;
          const diffX = touchStartX - touchEndX;
          if (Math.abs(diffX) > 50) { // Minimum swipe distance
            if (diffX > 0) {
              plusSlides(1); // Swipe left -> next
            } else {
              plusSlides(-1); // Swipe right -> previous
            }
          } else {
            const slide = document.getElementsByClassName("mySlides")[slideIndex - 1];
            slide.style.transform = "translateX(0)";
          }
          isDragging = false;
        }
      });
    }

    // Subir Fotos a Imgur
    async function uploadToImgur(file) {
      const formData = new FormData();
      formData.append('image', file);
      try {
        const response = await fetch('https://api.imgur.com/3/image', {
          method: 'POST',
          headers: {
            Authorization: 'Client-ID 7c3e4e7e6a7e7f9' // Replace with your Imgur Client-ID
          },
          body: formData
        });
        const data = await response.json();
        if (data.success) {
          return data.data.link;
        } else {
          console.error('Imgur upload failed:', data.data.error);
          alert('Error al subir la imagen. Intenta de nuevo.');
          return null;
        }
      } catch (error) {
        console.error('Upload error:', error);
        alert('Error al subir la imagen. Verifica tu conexión.');
        return null;
      }
    }

    // Subir Fotos
    document.getElementById('photoUpload').addEventListener('change', async (event) => {
      const files = event.target.files;
      const galleryGrid = document.getElementById('galleryGrid');
      const slideshowContainer = document.getElementById('slideshowContainer');
      for (let file of files) {
        const imgIndex = galleryImages.length;
        const imageUrl = await uploadToImgur(file);
        if (imageUrl) {
          galleryImages.push({ src: imageUrl, alt: `Foto subida ${imgIndex + 1}`, isLocal: false });
          
          // Agregar a la galería
          const galleryItem = document.createElement('div');
          galleryItem.classList.add('gallery-item');
          galleryItem.dataset.index = imgIndex;
          galleryItem.style.setProperty('--index', imgIndex);
          galleryItem.onclick = () => openModal(imgIndex);
          const img = document.createElement('img');
          img.src = imageUrl;
          img.alt = `Foto subida ${imgIndex + 1}`;
          galleryItem.appendChild(img);
          galleryGrid.appendChild(galleryItem);

          // Agregar al carousel del modal
          const slide = document.createElement('div');
          slide.classList.add('mySlides');
          slide.dataset.index = imgIndex;
          const slideImg = document.createElement('img');
          slideImg.src = imageUrl;
          slideImg.alt = `Foto subida ${imgIndex + 1}`;
          const deleteX = document.createElement('span');
          deleteX.classList.add('delete-x');
          deleteX.textContent = '×';
          deleteX.onclick = (event) => showConfirmDialog(imgIndex, event);
          const confirmDialog = document.createElement('div');
          confirmDialog.classList.add('confirm-dialog');
          confirmDialog.dataset.index = imgIndex;
          confirmDialog.innerHTML = `
            <p>¿Estás seguro de que quieres eliminar esta foto?</p>
            <button class="confirm-btn" onclick="confirmDelete(${imgIndex})">Confirmar</button>
            <button class="cancel-btn" onclick="cancelDelete()">Cancelar</button>
          `;
          slide.appendChild(slideImg);
          slide.appendChild(deleteX);
          slide.appendChild(confirmDialog);
          slideshowContainer.appendChild(slide);

          saveGalleryImages(); // Save to localStorage
        }
      }
      playClick();
    });

    // Reconstruir Galería
    function rebuildGallery() {
      const galleryGrid = document.getElementById('galleryGrid');
      const slideshowContainer = document.getElementById('slideshowContainer');
      galleryGrid.innerHTML = '';
      slideshowContainer.innerHTML = '';
      galleryImages.forEach((img, i) => {
        // Galería
        const galleryItem = document.createElement('div');
        galleryItem.classList.add('gallery-item');
        galleryItem.dataset.index = i;
        galleryItem.style.setProperty('--index', i);
        galleryItem.onclick = () => openModal(i);
        const imgElement = document.createElement('img');
        imgElement.src = img.src;
        imgElement.alt = img.alt;
        galleryItem.appendChild(imgElement);
        galleryGrid.appendChild(galleryItem);

        // Carousel
        const slide = document.createElement('div');
        slide.classList.add('mySlides');
        slide.dataset.index = i;
        const slideImg = document.createElement('img');
        slideImg.src = img.src;
        slideImg.alt = img.alt;
        const deleteX = document.createElement('span');
        deleteX.classList.add('delete-x');
        deleteX.textContent = '×';
        deleteX.onclick = (event) => showConfirmDialog(i, event);
        const confirmDialog = document.createElement('div');
        confirmDialog.classList.add('confirm-dialog');
        confirmDialog.dataset.index = i;
        confirmDialog.innerHTML = `
          <p>¿Estás seguro de que quieres eliminar esta foto?</p>
          <button class="confirm-btn" onclick="confirmDelete(${i})">Confirmar</button>
          <button class="cancel-btn" onclick="cancelDelete()">Cancelar</button>
        `;
        slide.appendChild(slideImg);
        slide.appendChild(deleteX);
        slide.appendChild(confirmDialog);
        slideshowContainer.appendChild(slide);
      });
    }

    // Diálogo de Confirmación
    function showConfirmDialog(index, event) {
      event.stopPropagation();
      document.querySelectorAll('.confirm-dialog').forEach(dialog => dialog.classList.remove('show'));
      const dialog = document.querySelector(`.mySlides[data-index="${index}"] .confirm-dialog`);
      if (dialog) dialog.classList.add('show');
      playClick();
    }

    function confirmDelete(index) {
      if (index >= galleryImages.length) return;
      galleryImages.splice(index, 1);
      saveGalleryImages();
      rebuildGallery();
      if (slideIndex > galleryImages.length) {
        slideIndex = galleryImages.length;
      }
      if (document.getElementById('photoModal').style.display === 'flex') {
        if (galleryImages.length === 0) {
          closeModal();
        } else {
          showSlides(slideIndex);
        }
      }
      playClick();
    }

    function cancelDelete() {
      document.querySelectorAll('.confirm-dialog').forEach(dialog => dialog.classList.remove('show'));
      playClick();
    }

    // Juego de Historia
    function nextStep(step) {
      document.querySelector('.story-step.active').classList.remove('active');
      document.getElementById('step' + step).classList.add('active');
      if (step === 5) {
        loadPromise();
      }
      playClick();
    }

    function prevStep(step) {
      document.querySelector('.story-step.active').classList.remove('active');
      document.getElementById('step' + step).classList.add('active');
      playClick();
    }

    function resetStory() {
      document.querySelectorAll('.story-step').forEach(step => step.classList.remove('active'));
      document.getElementById('step1').classList.add('active');
    }

    function returnToMain() {
      enamore.classList.remove('show');
      setTimeout(() => { cardStart.style.display = 'flex'; cardStart.style.opacity = 1; cardStart.style.transform = "scale(1)"; }, 500);
      playClick();
    }

    // Manejo de la Promesa
    const promiseInput = document.getElementById('promiseInput');
    const savePromiseBtn = document.getElementById('savePromiseBtn');
    const savedPromiseDiv = document.getElementById('savedPromise');

    function loadPromise() {
      const savedPromise = localStorage.getItem('jenniferPromise');
      if (savedPromise) {
        savedPromiseDiv.textContent = savedPromise;
        savedPromiseDiv.style.display = 'block';
        promiseInput.style.display = 'none';
        savePromiseBtn.textContent = 'Editar Promesa';
      } else {
        savedPromiseDiv.style.display = 'none';
        promiseInput.style.display = 'block';
        promiseInput.value = '';
        savePromiseBtn.textContent = 'Guardar Promesa';
      }
    }

    savePromiseBtn.addEventListener('click', () => {
      const savedPromise = localStorage.getItem('jenniferPromise');
      if (savedPromise && savePromiseBtn.textContent === 'Editar Promesa') {
        savedPromiseDiv.style.display = 'none';
        promiseInput.style.display = 'block';
        promiseInput.value = savedPromise;
        savePromiseBtn.textContent = 'Guardar Promesa';
      } else {
        const promiseText = promiseInput.value.trim();
        if (promiseText) {
          localStorage.setItem('jenniferPromise', promiseText);
          savedPromiseDiv.textContent = promiseText;
          savedPromiseDiv.style.display = 'block';
          promiseInput.style.display = 'none';
          savePromiseBtn.textContent = 'Editar Promesa';
        }
      }
      playClick();
    });

    // Initialize gallery on page load
    loadGalleryImages();
  </script>
</body>
</html>
